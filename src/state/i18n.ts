type Lang = 'es' | 'en'
let lang: Lang = (localStorage.getItem('banquinter:lang') as Lang) || (navigator.language?.startsWith('en') ? 'en' : 'es')
const listeners: Array<(l: Lang) => void> = []
const dict: Record<Lang, Record<string, string>> = {
  es: {
    brand: 'Banquinter',
    nav_features: 'Características',
    nav_about: 'Quiénes somos',
    nav_advantages: 'Ventajas',
    nav_subscriptions: 'Suscripciones',
    nav_terms: 'Términos',
    nav_login: 'Login',
    nav_register: 'Register',
    nav_panel: 'Panel',
    nav_investments: 'Inversiones',
    nav_piggy: 'Hucha',
    nav_history: 'Historial',
    nav_profile: 'Datos',
    nav_settings: 'Configuración',
    nav_admin: 'Admin',
    home_title: 'Banquinter',
    home_subtitle: 'Banco online moderno, seguro y elegante para gestionar tus finanzas.',
    home_cta_login: 'Entrar',
    home_cta_register: 'Crear cuenta',
    cat_account: 'Cuenta',
    cat_investments: 'Inversiones',
    cat_piggy: 'Hucha',
    cat_security: 'Seguridad',
    cat_subs: 'Suscripciones',
    cat_support: 'Soporte',
    about_title: 'Quiénes somos',
    adv_title: 'Ventajas',
    terms_title: 'Términos y condiciones',
    subs_title: 'Suscripciones',
    features_subtitle: 'Todo lo que necesitas en tu banco online',
    about_subtitle: 'Una experiencia financiera segura y clara',
    advantages_subtitle: 'Razones para elegirnos',
    login_title: 'Login',
    login_email: 'Email',
    login_password: 'Contraseña',
    login_show: 'Ver',
    login_hide: 'Ocultar',
    login_bankkey: 'Clave bancaria',
    login_submit: 'Entrar',
    register_title: 'Registro',
    register_username: 'Usuario',
    register_email: 'Email',
    register_password: 'Contraseña',
    register_submit: 'Crear cuenta',
    key_once_title: 'Tu clave bancaria única',
    key_once_subtitle: 'Esta clave se muestra solo una vez al crear la cuenta. Guárdala ahora.',
    copy: 'Copiar',
    close_continue_login: 'Cerrar y continuar a Login',
    close: 'Cerrar',
    wait: 'Espera...',
    dashboard_title: 'Mi cuenta',
    dashboard_balance: 'Saldo disponible',
    dashboard_accnum: 'Número de cuenta',
    transfer_title: 'Transferir',
    transfer_to: 'Cuenta destino',
    transfer_amount: 'Cantidad (€)',
    transfer_note: 'Concepto',
    transfer_send: 'Enviar',
    piggy_title: 'Hucha',
    piggy_account: 'Cuenta',
    piggy_pig: 'Hucha',
    piggy_amount: 'Cantidad',
    piggy_deposit: 'Depositar',
    piggy_withdraw: 'Retirar',
    investments_title: 'Inversiones',
    investments_tae: 'TAE actual',
    investments_amount: 'Cantidad inicial (€)',
    investments_months: 'Meses',
    investments_result: 'Resultado estimado',
    profile_title: 'Datos',
    profile_email: 'Email',
    profile_user: 'Usuario',
    profile_role: 'Rol',
    history_title: 'Historial',
    history_empty: 'Sin movimientos',
    settings_title: 'Configuración',
    settings_user: 'Usuario',
    settings_save: 'Guardar',
    settings_bankkey: 'Clave bancaria',
    settings_regen: 'Regenerar clave',
    info_title: 'Información y Términos',
    info_p1: 'Banquinter es una plataforma demo con medidas de seguridad modernas, autenticación por email y una clave bancaria única por usuario.',
    info_p2: 'Los datos sensibles no se almacenan en el repositorio. La configuración se realiza por variables de entorno en la plataforma de despliegue.',
    info_p3: 'La interfaz incluye panel de usuario, hucha, inversiones y panel de administrador.',
    admin_block: 'Bloquear',
    admin_unblock: 'Desbloquear',
    admin_promote: 'Promover a admin',
    table_date: 'Fecha',
    table_from: 'Desde',
    table_to: 'Hacia',
    table_amount: 'Cantidad',
    table_note: 'Concepto',
    tae_saved: 'TAE actualizado',
    updated: 'Actualizado',
    promoted: 'Promocionado',
    transfer_done: 'Transferencia realizada',
    deposited: 'Depositado',
    withdrawn: 'Retirado'
    ,images: 'Imágenes',
    logout: 'Salir',
    users_title: 'Usuarios',
    actions_label: 'Acciones',
    subs_free: 'Gratis',
    subs_premium: 'Premium',
    subs_business: 'Empresa',
    choose: 'Elegir'
    ,feat_account_desc: 'Saldo, movimientos y transferencias',
    feat_investments_desc: 'Simulador TAE y crecimiento',
    feat_piggy_desc: 'Ahorro separado y seguro',
    feat_security_desc: 'Autenticación y control de acceso',
    feat_subs_desc: 'Planes a tu medida',
    feat_support_desc: 'Atención directa',
    about_card1: 'Plataforma moderna con rendimiento y diseño de primera.',
    about_card2: 'Seguridad reforzada, verificación de clave bancaria y políticas estrictas.',
    about_card3: 'Herramientas de ahorro e inversión pensadas para ti.',
    about_p1: 'Banquinter combina accesibilidad con seguridad avanzada para que puedas operar con confianza: transferencias por número de cuenta, hucha, inversiones con simulador TAE y panel de administración para gestión y cumplimiento.',
    about_p2: 'Nuestro compromiso es ofrecer una experiencia fluida con visuales cuidados y un diseño clásico y moderno al mismo tiempo.',
    adv_item1: 'Interfaz clara y atractiva con animaciones suaves.',
    adv_item2: 'Operaciones coherentes y auditables.',
    adv_item3: 'Paneles dedicados para usuarios y administradores.',
    terms_body: 'Al usar Banquinter aceptas el tratamiento responsable de tus datos y las políticas de seguridad. Los servicios se ofrecen conforme a normativa aplicable.',
    subs_free_desc: 'Cuenta básica y hucha',
    subs_premium_desc: 'Funciones avanzadas e inversiones',
    subs_business_desc: 'Gestión multiusuario',
    tile_investments_sub: 'TAE y simulador',
    tile_piggy_sub: 'Ahorro separado',
    tile_history_sub: 'Movimientos',
    tile_profile_sub: 'Información',
    tile_settings_sub: 'Preferencias'
  },
  en: {
    brand: 'Banquinter',
    nav_features: 'Features',
    nav_about: 'About us',
    nav_advantages: 'Advantages',
    nav_subscriptions: 'Subscriptions',
    nav_terms: 'Terms',
    nav_login: 'Login',
    nav_register: 'Register',
    nav_panel: 'Dashboard',
    nav_investments: 'Investments',
    nav_piggy: 'Piggy bank',
    nav_history: 'History',
    nav_profile: 'Profile',
    nav_settings: 'Settings',
    nav_admin: 'Admin',
    home_title: 'Banquinter',
    home_subtitle: 'Modern, secure and elegant online banking for your finances.',
    home_cta_login: 'Login',
    home_cta_register: 'Create account',
    cat_account: 'Account',
    cat_investments: 'Investments',
    cat_piggy: 'Piggy bank',
    cat_security: 'Security',
    cat_subs: 'Subscriptions',
    cat_support: 'Support',
    about_title: 'About us',
    adv_title: 'Advantages',
    terms_title: 'Terms and conditions',
    subs_title: 'Subscriptions',
    features_subtitle: 'Everything you need in your online bank',
    about_subtitle: 'A secure and clear financial experience',
    advantages_subtitle: 'Reasons to choose us',
    login_title: 'Login',
    login_email: 'Email',
    login_password: 'Password',
    login_show: 'Show',
    login_hide: 'Hide',
    login_bankkey: 'Bank key',
    login_submit: 'Enter',
    register_title: 'Register',
    register_username: 'Username',
    register_email: 'Email',
    register_password: 'Password',
    register_submit: 'Create account',
    key_once_title: 'Your unique bank key',
    key_once_subtitle: 'This key shows only once when creating the account. Save it now.',
    copy: 'Copy',
    close_continue_login: 'Close and continue to Login',
    close: 'Close',
    wait: 'Wait...',
    dashboard_title: 'My account',
    dashboard_balance: 'Available balance',
    dashboard_accnum: 'Account number',
    transfer_title: 'Transfer',
    transfer_to: 'Destination account',
    transfer_amount: 'Amount (€)',
    transfer_note: 'Note',
    transfer_send: 'Send',
    piggy_title: 'Piggy bank',
    piggy_account: 'Account',
    piggy_pig: 'Piggy',
    piggy_amount: 'Amount',
    piggy_deposit: 'Deposit',
    piggy_withdraw: 'Withdraw',
    investments_title: 'Investments',
    investments_tae: 'Current APR',
    investments_amount: 'Initial amount (€)',
    investments_months: 'Months',
    investments_result: 'Estimated result',
    profile_title: 'Profile',
    profile_email: 'Email',
    profile_user: 'User',
    profile_role: 'Role',
    history_title: 'History',
    history_empty: 'No movements',
    settings_title: 'Settings',
    settings_user: 'User',
    settings_save: 'Save',
    settings_bankkey: 'Bank key',
    settings_regen: 'Regenerate key',
    info_title: 'Information and Terms',
    info_p1: 'Banquinter is a demo platform with modern security measures, email authentication and a unique bank key per user.',
    info_p2: 'Sensitive data is not stored in the repository. Configuration uses environment variables in the deployment platform.',
    info_p3: 'The interface includes user dashboard, piggy bank, investments and admin panel.',
    admin_block: 'Block',
    admin_unblock: 'Unblock',
    admin_promote: 'Promote to admin',
    table_date: 'Date',
    table_from: 'From',
    table_to: 'To',
    table_amount: 'Amount',
    table_note: 'Note',
    tae_saved: 'APR updated',
    updated: 'Updated',
    promoted: 'Promoted',
    transfer_done: 'Transfer completed',
    deposited: 'Deposited',
    withdrawn: 'Withdrawn'
    ,images: 'Images',
    logout: 'Logout',
    users_title: 'Users',
    actions_label: 'Actions',
    subs_free: 'Free',
    subs_premium: 'Premium',
    subs_business: 'Business',
    choose: 'Choose'
    ,feat_account_desc: 'Balance, transactions and transfers',
    feat_investments_desc: 'APR simulator and growth',
    feat_piggy_desc: 'Separate and safe savings',
    feat_security_desc: 'Authentication and access control',
    feat_subs_desc: 'Plans tailored to you',
    feat_support_desc: 'Direct support',
    about_card1: 'Modern platform with top performance and design.',
    about_card2: 'Enhanced security, bank key verification and strict policies.',
    about_card3: 'Savings and investment tools designed for you.',
    about_p1: 'Banquinter combines accessibility with advanced security so you can operate confidently: account-number transfers, piggy bank, APR simulator investments and an admin panel for management and compliance.',
    about_p2: 'Our commitment is a smooth experience with curated visuals and a classic yet modern design.',
    adv_item1: 'Clear and attractive interface with smooth animations.',
    adv_item2: 'Consistent and auditable operations.',
    adv_item3: 'Dedicated panels for users and administrators.',
    terms_body: 'By using Banquinter you accept responsible data handling and security policies. Services are offered under applicable regulations.',
    subs_free_desc: 'Basic account and piggy bank',
    subs_premium_desc: 'Advanced features and investments',
    subs_business_desc: 'Multi-user management',
    tile_investments_sub: 'APR & simulator',
    tile_piggy_sub: 'Separate savings',
    tile_history_sub: 'Movements',
    tile_profile_sub: 'Information',
    tile_settings_sub: 'Preferences'
  }
}

export function t(key: string) { return dict[lang][key] || key }
export function setLanguage(l: Lang) { lang = l; localStorage.setItem('banquinter:lang', l); listeners.forEach(fn => fn(lang)) }
export function subscribeLanguage(fn: (l: Lang) => void) { listeners.push(fn); fn(lang); return () => { const i = listeners.indexOf(fn); if (i>=0) listeners.splice(i,1) } }
